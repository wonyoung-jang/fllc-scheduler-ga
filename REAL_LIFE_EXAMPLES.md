# Real life examples of FLLC tournaments and GA usage

The `csv` and `ini` files in the `real_life_examples` directory are anonymized and normalized schedules of real FLLC tournaments. The configs are representations of how a schedule would be generated to match.

The `report.txt` files are reports generated by the `io.export.generate_summary_report` function.

## 2022-2023 example

First, here's the csv for the tournament `fllc_2022-2023/schedule.csv`:

```csv
Judging
Time,Room 1,Room 2,Room 3,Room 4,Room 5,Room 6,Room 7
08:00,1,2,3,4,5,6,7
08:45,8,9,10,11,12,13,14
09:30,15,16,17,18,19,20,21
10:15,22,23,24,25,26,27,28
11:00,29,30,31,32,33,34,35
11:45,36,37,38,39,40,41,42

Practice
Time,Table A1,Table A2,Table B1,Table B2,Table C1,Table C2,Table D1,Table D2
09:00,29,30,31,32,33,34,35,28
09:15,22,23,24,25,26,27,,
09:30,36,37,38,39,40,41,42,7
09:45,1,2,3,4,5,6,,
10:00,29,31,30,33,32,34,35,14
10:15,8,9,10,11,12,13,,
10:30,36,38,37,40,39,41,42,21
10:45,15,16,17,18,19,20,,
11:00,1,3,2,5,4,6,,
11:15,22,24,23,26,25,27,28,7
11:30,8,10,9,12,11,13,,
11:45,15,17,16,19,18,20,21,14

Table
Time,Table A1,Table A2,Table B1,Table B2,Table C1,Table C2,Table D1,Table D2
13:30,11,7,34,33,8,16,5,15
13:41,30,36,9,25,19,1,6,20
13:52,24,13,2,29,40,31,35,23
14:03,39,28,12,17,26,27,38,32
14:14,37,21,10,14,18,41,22,3
14:25,4,42,31,30,23,25,13,16
14:36,33,17,40,24,39,8,7,29
14:47,21,34,15,19,36,11,42,12
14:58,41,5,32,1,35,4,28,38
15:09,20,26,22,9,27,10,6,37
15:20,14,2,3,18,16,12,11,40
15:31,21,24,31,34,42,23,41,30
15:42,17,35,37,7,1,2,3,13
15:53,19,39,25,22,29,15,33,4
16:04,38,14,27,18,8,5,32,6
16:15,28,9,10,26,36,20,,
```

From this, I derived a config (only showing the round section): `fllc_2022-2023/config.ini`

```ini
[DEFAULT]
num_teams = 42

[round.judging]
round_type = Judging
rounds_per_team = 1
teams_per_round = 1
start_time = 08:00
duration_minutes = 45
num_locations = 7

[round.practice]
round_type = Practice
rounds_per_team = 2
teams_per_round = 2
start_time = 09:00
stop_time = 12:00
duration_minutes = 15
num_locations = 4

[round.table]
round_type = Table
rounds_per_team = 3
teams_per_round = 2
start_time = 13:30
duration_minutes = 11
num_locations = 4

[genetic]
population_size = 12
generations = 512
elite_size = 2
selection_size = 4
crossover_chance = 0.5
mutation_chance = 0.01
seed =                      
num_islands = 5
migration_interval = 10
migration_size = 3

[genetic.operator.selection]
selection_types = TournamentSelect, RandomSelect

[genetic.operator.crossover]
crossover_types = KPoint, Scattered, Uniform, RoundTypeCrossover, PartialCrossover
crossover_ks = 1, 2, 3 

[genetic.operator.mutation]
mutation_types = 
    SwapMatch_CrossTimeLocation, 
    SwapMatch_SameLocation, 
    SwapMatch_SameTime, 
    SwapTeam_CrossTimeLocation, 
    SwapTeam_SameLocation, 
    SwapTeam_SameTime,
    SwapTableSide
```

Importing and adding to the population through the CLI (I'm using PowerShell):

```bash
uv run fll_scheduler_ga `
--config_file .\real_life_examples\fllc_2022-2023\config.ini `
--import_file .\real_life_examples\fllc_2022-2023\schedule.csv `
--add_import_to_population `
--flush
```

First, the report summary: `fllc_2022-2023/report.txt`

```txt
Objective Scores:
  - BreakTime        : 0.397854
  - TableConsistency : 0.015200
  - OpponentVariety  : 0.499652

Total            : 0.912706
Average          : 0.304235

Team fitnesses (sorted by total fitness descending):

Max     : 2.131207
Min     : 0.970362
Range   : 1.160846
Average : 1.593379

Team |BreakTime |TableConsistency |OpponentVariety |Sum
--------------------------------------------------------
49   |0.7585    |0.3727           |1.0000          |2.1312
47   |0.8411    |0.0307           |1.0000          |1.8718
46   |0.7221    |0.1235           |1.0000          |1.8455
51   |0.7907    |0.0000           |1.0000          |1.7907
38   |0.6575    |0.1235           |1.0000          |1.7810
52   |0.7196    |0.0307           |1.0000          |1.7503
25   |0.6240    |0.1235           |1.0000          |1.7475
45   |0.6186    |0.1235           |1.0000          |1.7421
37   |0.6928    |0.0307           |1.0000          |1.7235
11   |0.5870    |0.1235           |1.0000          |1.7105
48   |0.6791    |0.0307           |1.0000          |1.7098
17   |0.5815    |0.1235           |1.0000          |1.7050
23   |0.5763    |0.1235           |1.0000          |1.6998
34   |0.5658    |0.1235           |1.0000          |1.6893
44   |0.6392    |0.0307           |1.0000          |1.6699
50   |0.6262    |0.0307           |1.0000          |1.6569
30   |0.6244    |0.0307           |1.0000          |1.6551
42   |0.6153    |0.0307           |1.0000          |1.6460
39   |0.6019    |0.0307           |1.0000          |1.6326
27   |0.6309    |0.0000           |1.0000          |1.6309
41   |0.5796    |0.0307           |1.0000          |1.6103
28   |0.5772    |0.0307           |1.0000          |1.6078
7    |0.5771    |0.0307           |1.0000          |1.6078
16   |0.5738    |0.0307           |1.0000          |1.6045
2    |0.5687    |0.0307           |1.0000          |1.5994
43   |0.5676    |0.0307           |1.0000          |1.5983
40   |0.5671    |0.0307           |1.0000          |1.5978
24   |0.5950    |0.0000           |1.0000          |1.5950
12   |0.5603    |0.0307           |1.0000          |1.5910
29   |0.5579    |0.0307           |1.0000          |1.5886
10   |0.5517    |0.0307           |1.0000          |1.5823
4    |0.5436    |0.0307           |1.0000          |1.5742
8    |0.5410    |0.0307           |1.0000          |1.5717
36   |0.5406    |0.0307           |1.0000          |1.5712
6    |0.5711    |0.0000           |1.0000          |1.5711
20   |0.5377    |0.0307           |1.0000          |1.5683
5    |0.5351    |0.0307           |1.0000          |1.5658
13   |0.5348    |0.0307           |1.0000          |1.5655
9    |0.5347    |0.0307           |1.0000          |1.5654
14   |0.5644    |0.0000           |1.0000          |1.5644
1    |0.5337    |0.0307           |1.0000          |1.5643
19   |0.5320    |0.0307           |1.0000          |1.5627
3    |0.5282    |0.0307           |1.0000          |1.5589
26   |0.5565    |0.0000           |1.0000          |1.5565
18   |0.5070    |0.0307           |1.0000          |1.5377
35   |0.5348    |0.0000           |1.0000          |1.5348
15   |0.5185    |0.0000           |1.0000          |1.5185
33   |0.5098    |0.0000           |1.0000          |1.5098
31   |0.5582    |0.1235           |0.3773          |1.0589
22   |0.6032    |0.0307           |0.3773          |1.0112
21   |0.6051    |0.0000           |0.3773          |0.9824
32   |0.5624    |0.0307           |0.3773          |0.9704
```

With the current configuration, this run takes my machine 28 seconds to complete. Here is the report for the schedule in the Pareto front with the highest total fitness (only showing the aggregated parts on top):

```txt
Objective Scores:
  - BreakTime        : 0.455408
  - TableConsistency : 0.062034
  - OpponentVariety  : 1.000000

Total            : 1.517442
Average          : 0.505814

Team fitnesses (sorted by total fitness descending):

Max     : 2.096146
Min     : 1.547761
Range   : 0.548385
Average : 1.767262
```

There is improvement from the imported schedule on almost every objective except for BreakTime.

Since the FLLC Scheduler will automatically save the best (or all) schedules, it's easy to simply run this configuration again. This time I will omit the importing and adding of the schedule, and the `--flush` command, which deletes the saved schedules from the previous run:

```bash
uv run fll_scheduler_ga `
--config_file .\real_life_examples\fllc_2022-2023\config.ini
```

Now we can see improvements in every objective:

```txt
Objective Scores:
  - BreakTime        : 0.499260
  - TableConsistency : 0.132480
  - OpponentVariety  : 1.000000

Total            : 1.631740
Average          : 0.543913

Team fitnesses (sorted by total fitness descending):

Max     : 2.079923
Min     : 1.673971
Range   : 0.405952
Average : 1.886831
```

Normally, genetic algorithms and schedulers are left running for much longer than the ~56 seconds of runtime we spent here, and we would have seen even better results had we done that, but I hope this shows how this program can be useful for anybody hosting an event!

The following are the plotting images, which shows the algorithm is converging on optimal solutions, and also shows the algorithm is not close to converging after 1024 generations.

### 2022-2023 plot images

#### Average Fitness over Generations

![512 generations Fitness over generations](/assets/2022-2023/after_512_generations/fitness_vs_generation.png)

![1024 generations Fitness over generations](/assets/2022-2023/after_1024_generations/fitness_vs_generation.png)

#### 3D Scatter Plot

![512 generations Scatter](/assets/2022-2023/after_512_generations/pareto_scatter_3d.png)

![1024 generations Scatter](/assets/2022-2023/after_1024_generations/pareto_scatter_3d.png)