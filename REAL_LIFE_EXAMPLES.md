# Real life examples of FLLC tournaments and GA usage

The `csv` and `ini` files in the `real_life_examples` directory are anonymized and normalized schedules of real FLLC tournaments. The configs are representations of how a schedule would be generated to match.

The `report.txt` files are reports generated by the `io.export.generate_summary_report` function.

## 2022-2023 example

First, here's the csv for the tournament `fllc_2022-2023/schedule.csv`:

```csv
Judging
Time,Room 1,Room 2,Room 3,Room 4,Room 5,Room 6,Room 7
08:00,1,2,3,4,5,6,7
08:45,8,9,10,11,12,13,14
09:30,15,16,17,18,19,20,21
10:15,22,23,24,25,26,27,28
11:00,29,30,31,32,33,34,35
11:45,36,37,38,39,40,41,42

Practice
Time,Table A1,Table A2,Table B1,Table B2,Table C1,Table C2,Table D1,Table D2
09:00,29,30,31,32,33,34,35,28
09:15,22,23,24,25,26,27,,
09:30,36,37,38,39,40,41,42,7
09:45,1,2,3,4,5,6,,
10:00,29,31,30,33,32,34,35,14
10:15,8,9,10,11,12,13,,
10:30,36,38,37,40,39,41,42,21
10:45,15,16,17,18,19,20,,
11:00,1,3,2,5,4,6,,
11:15,22,24,23,26,25,27,28,7
11:30,8,10,9,12,11,13,,
11:45,15,17,16,19,18,20,21,14

Table
Time,Table A1,Table A2,Table B1,Table B2,Table C1,Table C2,Table D1,Table D2
13:30,11,7,34,33,8,16,5,15
13:41,30,36,9,25,19,1,6,20
13:52,24,13,2,29,40,31,35,23
14:03,39,28,12,17,26,27,38,32
14:14,37,21,10,14,18,41,22,3
14:25,4,42,31,30,23,25,13,16
14:36,33,17,40,24,39,8,7,29
14:47,21,34,15,19,36,11,42,12
14:58,41,5,32,1,35,4,28,38
15:09,20,26,22,9,27,10,6,37
15:20,14,2,3,18,16,12,11,40
15:31,21,24,31,34,42,23,41,30
15:42,17,35,37,7,1,2,3,13
15:53,19,39,25,22,29,15,33,4
16:04,38,14,27,18,8,5,32,6
16:15,28,9,10,26,36,20,,
```

From this, I derived a config (only showing the round section): `fllc_2022-2023/config.ini`

```ini
[DEFAULT]
num_teams = 42
weight_mean = 3
weight_variation = 1
weight_range = 1

[round.judging]
round_type = Judging
rounds_per_team = 1
teams_per_round = 1
start_time = 08:00
duration_minutes = 45
num_locations = 7

[round.practice]
round_type = Practice
rounds_per_team = 2
teams_per_round = 2
start_time = 09:00
stop_time = 12:00
duration_minutes = 15
num_locations = 4

[round.table]
round_type = Table
rounds_per_team = 3
teams_per_round = 2
start_time = 13:30
duration_minutes = 11
num_locations = 4

[genetic]
population_size = 12
generations = 512
offspring_size = 6
selection_size = 8
crossover_chance = 0.5
mutation_chance = 0.05
seed =
num_islands = 5
migration_interval = 10
migration_size = 4

[genetic.operator.selection]
selection_types = TournamentSelect, RandomSelect

[genetic.operator.crossover]
crossover_types = KPoint, Scattered, Uniform, RoundTypeCrossover, PartialCrossover
crossover_ks = 1, 2, 3 

[genetic.operator.mutation]
mutation_types = 
    SwapMatch_CrossTimeLocation, 
    SwapMatch_SameLocation, 
    SwapMatch_SameTime, 
    SwapTeam_CrossTimeLocation, 
    SwapTeam_SameLocation, 
    SwapTeam_SameTime,
    SwapTableSide
```

Importing and adding to the population through the CLI (I'm using PowerShell):

```bash
uv run fll_scheduler_ga `
--config_file .\real_life_examples\fllc_2022-2023\config.ini `
--import_file .\real_life_examples\fllc_2022-2023\schedule.csv `
--add_import_to_population `
--flush
```

First, the report summary: `fllc_2022-2023/report.txt`

```txt
Objective Scores:
  - BreakTime        : 0.740190
  - TableConsistency : 0.405961
  - OpponentVariety  : 0.923514

Total            : 2.069664
Average          : 0.689888

Team fitnesses (sorted by total fitness descending):

Max     : 2.377574
Min     : 1.574058
Range   : 0.803516
Average : 1.933225

Team |BreakTime |TableConsistency |OpponentVariety |Sum
--------------------------------------------------------
18   |0.6333    |0.7442           |1.0000          |2.3776
36   |0.8797    |0.4924           |1.0000          |2.3721
8    |0.7971    |0.4924           |1.0000          |2.2895
9    |0.7701    |0.4924           |1.0000          |2.2624
20   |0.7420    |0.4924           |1.0000          |2.2343
19   |0.7366    |0.4924           |1.0000          |2.2290
6    |0.7123    |0.4924           |1.0000          |2.2047
41   |0.6765    |0.4924           |1.0000          |2.1688
35   |0.6711    |0.4924           |1.0000          |2.1635
10   |0.6673    |0.4924           |1.0000          |2.1597
31   |0.6480    |0.4924           |1.0000          |2.1403
42   |0.6268    |0.4924           |1.0000          |2.1192
15   |0.7699    |0.2443           |1.0000          |2.0142
40   |0.7624    |0.2443           |1.0000          |2.0067
7    |0.7530    |0.2443           |1.0000          |1.9973
39   |0.7390    |0.2443           |1.0000          |1.9833
37   |0.6962    |0.2443           |1.0000          |1.9405
29   |0.6803    |0.2443           |1.0000          |1.9246
13   |0.6740    |0.2443           |1.0000          |1.9183
14   |0.6626    |0.2443           |1.0000          |1.9069
2    |0.6317    |0.4924           |0.7557          |1.8797
17   |0.6307    |0.2443           |1.0000          |1.8750
25   |0.6214    |0.2443           |1.0000          |1.8657
28   |0.6191    |0.2443           |1.0000          |1.8634
26   |0.6056    |0.4924           |0.7557          |1.8537
27   |0.5933    |0.4924           |0.7557          |1.8413
3    |0.5893    |0.2443           |1.0000          |1.8336
24   |0.5802    |0.2443           |1.0000          |1.8245
21   |0.5721    |0.2443           |1.0000          |1.8164
38   |0.8014    |0.0000           |1.0000          |1.8014
22   |0.5542    |0.2443           |1.0000          |1.7985
33   |0.7705    |0.2443           |0.7557          |1.7705
5    |0.7529    |0.0000           |1.0000          |1.7529
16   |0.7420    |0.0000           |1.0000          |1.7420
34   |0.7276    |0.2443           |0.7557          |1.7276
11   |0.7147    |0.0000           |1.0000          |1.7147
30   |0.6945    |0.0000           |1.0000          |1.6945
1    |0.6839    |0.2443           |0.7557          |1.6839
32   |0.6688    |0.0000           |1.0000          |1.6688
12   |0.6163    |0.0000           |1.0000          |1.6163
4    |0.5837    |0.0000           |1.0000          |1.5837
23   |0.5741    |0.0000           |1.0000          |1.5741
```

With the current configuration, this run takes my machine 26 seconds to complete. Here is the report for the schedule in the Pareto front with the highest total fitness (only showing the aggregated parts on top):

```txt
Objective Scores:
  - BreakTime        : 0.655576
  - TableConsistency : 0.576032
  - OpponentVariety  : 1.000000

Total            : 2.231608
Average          : 0.743869

Team fitnesses (sorted by total fitness descending):

Max     : 2.235375
Min     : 1.720911
Range   : 0.514464
Average : 2.014649
```

![512 generations Fitness over generations](/assets/2022-2023/after_512_generations/fitness_vs_generation.png)

![512 generations Scatter](/assets/2022-2023/after_512_generations/pareto_scatter_3d.png)

There is improvement from the imported schedule on almost every objective except for BreakTime.

Since the FLLC Scheduler will automatically save the best (or all) schedules, it's easy to simply run this configuration again. This time I will omit the importing and adding of the schedule, and the `--flush` command, which deletes the saved schedules from the previous run:

```bash
uv run fll_scheduler_ga `
--config_file .\real_life_examples\fllc_2022-2023\config.ini
```

Now we can see improvements in every objective, but still doesn't beat our original schedule in break time consistency:

*Run 2 (18s)*

```txt
Objective Scores:
  - BreakTime        : 0.730126
  - TableConsistency : 0.620243
  - OpponentVariety  : 1.000000

Total            : 2.350369
Average          : 0.783456

Team fitnesses (sorted by total fitness descending):

Max     : 2.461994
Min     : 1.779742
Range   : 0.682252
Average : 2.165525
```

![1024 generations Fitness over generations](/assets/2022-2023/after_1024_generations/fitness_vs_generation.png)

![1024 generations Scatter](/assets/2022-2023/after_1024_generations/pareto_scatter_3d.png)

Running it a third time gives us improvements in every objective from our original:

*Run 3 (19s)*

```txt
Objective Scores:
  - BreakTime        : 0.752177
  - TableConsistency : 0.685561
  - OpponentVariety  : 1.000000

Total            : 2.437737
Average          : 0.812579

Team fitnesses (sorted by total fitness descending):

Max     : 2.471839
Min     : 2.073668
Range   : 0.398171
Average : 2.252159
```

![1536 generations Fitness over generations](/assets/2022-2023/after_1536_generations/fitness_vs_generation.png)

![1536 generations Scatter](/assets/2022-2023/after_1536_generations/pareto_scatter_3d.png)

Normally, genetic algorithms and schedulers are left running for much longer than the 63 seconds of runtime we spent here, and we would have seen even better results had we done that, but I hope this shows how this program can be useful for anybody hosting an event!

Below each result are images for a plot of fitness in each objective over generations, and a scatter plot of each generated schedule. These show two things: 

1. The algorithm is converging on a "front" (indicated by the line of purple points in the scatter plot)
2. The algorithm isn't close to "fully" converging after 1536 generations

And just for fun, here is the schedule CSV for the most fit of the front from the last run:

```csv
Judging
Time,Room 1,Room 2,Room 3,Room 4,Room 5,Room 6,Room 7
08:00,1,2,3,4,5,6,7
08:45,8,9,10,11,12,13,14
09:30,15,16,17,18,19,20,21
10:15,22,23,24,25,26,27,28
11:00,29,30,31,32,33,34,35
11:45,36,37,38,39,40,41,42

Practice
Time,Table A1,Table A2,Table B1,Table B2,Table C1,Table C2,Table D1,Table D2
09:00,29,30,32,31,33,34,35,28
09:15,36,24,41,26,1,27,42,25
09:30,,,23,40,,,38,7
09:45,22,2,12,8,29,6,37,39
10:00,4,31,,,32,34,35,14
10:15,3,9,10,39,36,13,30,33
10:30,15,11,41,40,,,42,21
10:45,,,17,5,19,20,,
11:00,38,10,18,4,1,6,37,16
11:15,3,2,9,12,28,7,25,14
11:30,22,24,23,26,11,13,8,21
11:45,15,17,16,19,18,20,5,27

Table
Time,Table A1,Table A2,Table B1,Table B2,Table C1,Table C2,Table D1,Table D2
13:30,23,10,18,12,34,15,25,21
13:41,22,31,16,3,30,6,5,33
13:52,24,13,37,19,32,14,38,28
14:03,1,9,39,5,29,15,35,33
14:14,20,26,27,4,36,41,22,3
14:25,38,37,2,23,17,7,42,13
14:36,40,34,14,39,35,8,6,25
14:47,29,11,18,36,41,7,32,12
14:58,15,2,16,1,21,4,30,20
15:09,24,34,9,19,18,27,37,13
15:20,42,26,10,40,33,8,32,21
15:31,1,2,17,31,11,14,6,22
15:42,23,42,29,7,28,41,,
15:53,4,10,9,5,35,20,25,16
16:04,36,30,39,40,17,27,26,3
16:15,24,11,12,31,19,38,8,28
```